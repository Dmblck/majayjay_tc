{"ast":null,"code":"// src/services/orsService.js\nconst ORS_API_KEY = process.env.REACT_APP_ORS_KEY;\n\n/**\r\n * Get detailed route info between two points using OpenRouteService\r\n * @param {Object} start - { lat, lng }\r\n * @param {Object} end - { lat, lng }\r\n * @param {string} mode - ORS travel mode (e.g. \"driving-car\", \"foot-walking\")\r\n */\nexport async function getRouteInfo(start, end, mode = \"driving-car\") {\n  if (!start || !end || !start.lat || !start.lng || !end.lat || !end.lng) {\n    throw new Error(\"Invalid coordinates passed to getRouteInfo()\");\n  }\n  try {\n    const res = await fetch(`https://api.openrouteservice.org/v2/directions/${mode}`, {\n      method: \"POST\",\n      headers: {\n        Authorization: ORS_API_KEY,\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        coordinates: [[start.lng, start.lat],\n        // ✅ Correct order: [longitude, latitude]\n        [end.lng, end.lat]],\n        preference: \"fastest\",\n        instructions: false\n      })\n    });\n    const data = await res.json();\n    if (!res.ok) {\n      var _data$error;\n      console.error(\"ORS API error:\", data);\n      throw new Error(`Routing failed: ${((_data$error = data.error) === null || _data$error === void 0 ? void 0 : _data$error.message) || res.statusText}`);\n    }\n    return {\n      coords: data.routes[0].geometry,\n      distance: data.routes[0].summary.distance,\n      duration: data.routes[0].summary.duration,\n      geometry: data.routes[0].geometry\n    };\n  } catch (err) {\n    console.error(\"Error fetching route from ORS:\", err);\n    throw err;\n  }\n}\n\n/**\r\n * Snap a point to the nearest road\r\n */\nexport async function snapToRoad(poi, profile = \"driving-car\") {\n  try {\n    const res = await fetch(`https://api.openrouteservice.org/v2/snap/${profile}`, {\n      method: \"POST\",\n      headers: {\n        Authorization: ORS_API_KEY,\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        coordinates: [[poi.lng, poi.lat]]\n      })\n    });\n    const data = await res.json();\n    if (data.snappedLocations && data.snappedLocations.length) {\n      const snapped = data.snappedLocations[0].location;\n      return {\n        lat: snapped[1],\n        lng: snapped[0]\n      };\n    }\n    return poi;\n  } catch (err) {\n    console.warn(\"SnapToRoad failed:\", err);\n    return poi;\n  }\n}\n\n/**\r\n * Fetch a route segment between two snapped points\r\n */\nexport async function fetchRouteSegment(from, to, profile = \"driving-car\") {\n  if (!from || !to) return null;\n  const snappedFrom = await snapToRoad(from, profile);\n  const snappedTo = await snapToRoad(to, profile);\n  try {\n    var _data$features;\n    const res = await fetch(`https://api.openrouteservice.org/v2/directions/${profile}/geojson`, {\n      method: \"POST\",\n      headers: {\n        Authorization: ORS_API_KEY,\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        coordinates: [[snappedFrom.lng, snappedFrom.lat], [snappedTo.lng, snappedTo.lat]],\n        preference: \"fastest\",\n        instructions: false\n      })\n    });\n    const data = await res.json();\n    if ((_data$features = data.features) !== null && _data$features !== void 0 && _data$features.length) {\n      return {\n        coords: data.features[0].geometry.coordinates.map(([lng, lat]) => [lat, lng]),\n        summary: data.features[0].properties.summary,\n        profile\n      };\n    }\n  } catch (err) {\n    console.warn(\"fetchRouteSegment failed:\", err);\n  }\n  return null;\n}","map":{"version":3,"names":["ORS_API_KEY","process","env","REACT_APP_ORS_KEY","getRouteInfo","start","end","mode","lat","lng","Error","res","fetch","method","headers","Authorization","body","JSON","stringify","coordinates","preference","instructions","data","json","ok","_data$error","console","error","message","statusText","coords","routes","geometry","distance","summary","duration","err","snapToRoad","poi","profile","snappedLocations","length","snapped","location","warn","fetchRouteSegment","from","to","snappedFrom","snappedTo","_data$features","features","map","properties"],"sources":["C:/xampp/htdocs/Majayjay Tourism Circuit/src/services/orsService.js"],"sourcesContent":["// src/services/orsService.js\r\nconst ORS_API_KEY = process.env.REACT_APP_ORS_KEY;\r\n\r\n/**\r\n * Get detailed route info between two points using OpenRouteService\r\n * @param {Object} start - { lat, lng }\r\n * @param {Object} end - { lat, lng }\r\n * @param {string} mode - ORS travel mode (e.g. \"driving-car\", \"foot-walking\")\r\n */\r\nexport async function getRouteInfo(start, end, mode = \"driving-car\") {\r\n  if (!start || !end || !start.lat || !start.lng || !end.lat || !end.lng) {\r\n    throw new Error(\"Invalid coordinates passed to getRouteInfo()\");\r\n  }\r\n\r\n  try {\r\n    const res = await fetch(`https://api.openrouteservice.org/v2/directions/${mode}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: ORS_API_KEY,\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        coordinates: [\r\n          [start.lng, start.lat], // ✅ Correct order: [longitude, latitude]\r\n          [end.lng, end.lat],\r\n        ],\r\n        preference: \"fastest\",\r\n        instructions: false,\r\n      }),\r\n    });\r\n\r\n    const data = await res.json();\r\n\r\n    if (!res.ok) {\r\n      console.error(\"ORS API error:\", data);\r\n      throw new Error(`Routing failed: ${data.error?.message || res.statusText}`);\r\n    }\r\n\r\n    return {\r\n      coords: data.routes[0].geometry,\r\n      distance: data.routes[0].summary.distance,\r\n      duration: data.routes[0].summary.duration,\r\n      geometry: data.routes[0].geometry,\r\n    };\r\n  } catch (err) {\r\n    console.error(\"Error fetching route from ORS:\", err);\r\n    throw err;\r\n  }\r\n}\r\n\r\n/**\r\n * Snap a point to the nearest road\r\n */\r\nexport async function snapToRoad(poi, profile = \"driving-car\") {\r\n  try {\r\n    const res = await fetch(`https://api.openrouteservice.org/v2/snap/${profile}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: ORS_API_KEY,\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ coordinates: [[poi.lng, poi.lat]] }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    if (data.snappedLocations && data.snappedLocations.length) {\r\n      const snapped = data.snappedLocations[0].location;\r\n      return { lat: snapped[1], lng: snapped[0] };\r\n    }\r\n\r\n    return poi;\r\n  } catch (err) {\r\n    console.warn(\"SnapToRoad failed:\", err);\r\n    return poi;\r\n  }\r\n}\r\n\r\n/**\r\n * Fetch a route segment between two snapped points\r\n */\r\nexport async function fetchRouteSegment(from, to, profile = \"driving-car\") {\r\n  if (!from || !to) return null;\r\n\r\n  const snappedFrom = await snapToRoad(from, profile);\r\n  const snappedTo = await snapToRoad(to, profile);\r\n\r\n  try {\r\n    const res = await fetch(`https://api.openrouteservice.org/v2/directions/${profile}/geojson`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: ORS_API_KEY,\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        coordinates: [\r\n          [snappedFrom.lng, snappedFrom.lat],\r\n          [snappedTo.lng, snappedTo.lat],\r\n        ],\r\n        preference: \"fastest\",\r\n        instructions: false,\r\n      }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    if (data.features?.length) {\r\n      return {\r\n        coords: data.features[0].geometry.coordinates.map(([lng, lat]) => [lat, lng]),\r\n        summary: data.features[0].properties.summary,\r\n        profile,\r\n      };\r\n    }\r\n  } catch (err) {\r\n    console.warn(\"fetchRouteSegment failed:\", err);\r\n  }\r\n\r\n  return null;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}