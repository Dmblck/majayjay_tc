{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\Majayjay Tourism Circuit\\\\src\\\\pages\\\\RouteDetails.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from \"react-leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport L from \"leaflet\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function RouteDetails() {\n  _s();\n  var _location$state;\n  const location = useLocation();\n  const navigate = useNavigate();\n  const routeSpots = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.itinerary) || [];\n  const [segments, setSegments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [poiDetails, setPoiDetails] = useState([]);\n  const [saving, setSaving] = useState(false);\n  const [saveMessage, setSaveMessage] = useState(\"\");\n  const [status, setStatus] = useState(\"pending\");\n  const [savedItineraryId, setSavedItineraryId] = useState(null);\n  const [userLocation, setUserLocation] = useState(null);\n  const mapRef = useRef(null);\n  const ORS_API_KEY = \"eyJvcmciOiI1YjNjZTM1OTc4NTExMTAwMDFjZjYyNDgiLCJpZCI6ImJhNWU3NmIxOTRmMzQyYTg4NzY4MDc2MzVmZDY1ZDRhIiwiaCI6Im11cm11cjY0In0=\";\n\n  // ðŸ”µ Custom numbered icon\n  const numberedIcon = number => L.divIcon({\n    html: `<div style=\"\n        background:#1976d2;\n        color:#fff;\n        width:28px;\n        height:28px;\n        border-radius:50%;\n        text-align:center;\n        line-height:28px;\n        font-weight:600;\n        border:2px solid #fff;\n        box-shadow:0 2px 6px rgba(0,0,0,0.3);\n      \">${number}</div>`,\n    className: \"\",\n    iconSize: [28, 28]\n  });\n\n  // Track live user location\n  useEffect(() => {\n    if (!(\"geolocation\" in navigator)) {\n      setUserLocation({\n        lat: 14.1461,\n        lng: 121.5012\n      });\n      return;\n    }\n    const watchId = navigator.geolocation.watchPosition(pos => {\n      const loc = {\n        lat: pos.coords.latitude,\n        lng: pos.coords.longitude\n      };\n      setUserLocation(loc);\n      if (mapRef.current) {\n        try {\n          mapRef.current.setView([loc.lat, loc.lng], 14, {\n            animate: true\n          });\n        } catch {}\n      }\n    }, err => {\n      console.warn(\"Geolocation error:\", err.message);\n      setUserLocation({\n        lat: 14.1461,\n        lng: 121.5012\n      });\n    }, {\n      enableHighAccuracy: true,\n      timeout: 10000,\n      maximumAge: 0\n    });\n    return () => navigator.geolocation.clearWatch(watchId);\n  }, []);\n\n  // Fetch POI details from backend\n  const fetchPoiDetails = async () => {\n    try {\n      const res = await fetch(\"http://localhost:5000/api/pois\");\n      const data = await res.json();\n      const matched = routeSpots.map(spot => data.find(poi => poi.name === spot.name || poi.id === spot.id));\n      setPoiDetails(matched);\n    } catch (err) {\n      console.error(\"Error fetching POI details:\", err);\n    }\n  };\n\n  // Snap POI to road\n  const snapToRoad = async poi => {\n    try {\n      var _data$snappedLocation;\n      const res = await fetch(\"https://api.openrouteservice.org/v2/snap/driving-car\", {\n        method: \"POST\",\n        headers: {\n          Authorization: ORS_API_KEY,\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          coordinates: [[poi.lng, poi.lat]]\n        })\n      });\n      const data = await res.json();\n      if ((_data$snappedLocation = data.snappedLocations) !== null && _data$snappedLocation !== void 0 && _data$snappedLocation.length) {\n        const [lng, lat] = data.snappedLocations[0].location;\n        return {\n          lat,\n          lng\n        };\n      }\n      return poi;\n    } catch {\n      return poi;\n    }\n  };\n\n  // Fetch route segments\n  const fetchRouteSegment = async (from, to) => {\n    if (!from || !to) return null;\n    const snappedFrom = await snapToRoad(from);\n    const snappedTo = await snapToRoad(to);\n    try {\n      var _data$features;\n      const res = await fetch(\"https://api.openrouteservice.org/v2/directions/driving-car/geojson\", {\n        method: \"POST\",\n        headers: {\n          Authorization: ORS_API_KEY,\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          coordinates: [[snappedFrom.lng, snappedFrom.lat], [snappedTo.lng, snappedTo.lat]],\n          preference: \"fastest\",\n          instructions: false\n        })\n      });\n      const data = await res.json();\n      if ((_data$features = data.features) !== null && _data$features !== void 0 && _data$features.length) {\n        const coords = data.features[0].geometry.coordinates.map(([lng, lat]) => [lat, lng]);\n        const summary = data.features[0].properties.summary;\n        return {\n          coords,\n          summary\n        };\n      }\n    } catch {\n      return {\n        coords: [[from.lat, from.lng], [to.lat, to.lng]],\n        summary: {\n          distance: 0,\n          duration: 0\n        }\n      };\n    }\n  };\n\n  // Load segments & POIs\n  useEffect(() => {\n    const loadAllSegments = async () => {\n      if (!userLocation) return;\n      setLoading(true);\n      await fetchPoiDetails();\n      const points = [userLocation, ...routeSpots];\n      const segs = [];\n      for (let i = 0; i < points.length - 1; i++) {\n        const seg = await fetchRouteSegment(points[i], points[i + 1]);\n        if (seg) segs.push(seg);\n      }\n      setSegments(segs);\n      setLoading(false);\n    };\n    if (routeSpots.length > 0) loadAllSegments();\n  }, [userLocation, routeSpots]);\n  const handleZoomToPoi = poi => {\n    if (mapRef.current) mapRef.current.setView([poi.lat, poi.lng], 16, {\n      animate: true\n    });\n  };\n  const formatDistance = meters => `${(meters / 1000).toFixed(2)} km`;\n  const formatDuration = seconds => `${Math.floor(seconds / 60)} min`;\n\n  // Save itinerary\n  const handleSaveItinerary = async () => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) {\n      alert(\"Please log in to save itineraries.\");\n      return;\n    }\n    setSaving(true);\n    setSaveMessage(\"\");\n    try {\n      const res = await fetch(\"http://localhost:5000/api/itineraries\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          name: `Route - ${new Date().toLocaleDateString()}`,\n          route_data: routeSpots\n        })\n      });\n      const data = await res.json();\n      if (res.ok) {\n        setSaveMessage(\"âœ… Itinerary saved successfully!\");\n        setStatus(\"pending\");\n        setSavedItineraryId(data.itinerary.id);\n      } else setSaveMessage(`âŒ Failed: ${data.message || \"Unknown error\"}`);\n    } catch {\n      setSaveMessage(\"âŒ Server error while saving itinerary.\");\n    } finally {\n      setSaving(false);\n      setTimeout(() => setSaveMessage(\"\"), 4000);\n    }\n  };\n\n  // Update status (Finish / Cancel)\n  const updateStatus = async newStatus => {\n    if (!savedItineraryId) return alert(\"Please save itinerary first.\");\n    const token = localStorage.getItem(\"token\");\n    try {\n      const res = await fetch(`http://localhost:5000/api/itineraries/${savedItineraryId}/status`, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          status: newStatus\n        })\n      });\n      const data = await res.json();\n      if (res.ok && data.success) {\n        setStatus(newStatus);\n        setSaveMessage(`Itinerary ${newStatus} successfully.`);\n      } else setSaveMessage(\"Failed to update status.\");\n    } catch {\n      setSaveMessage(\"Error updating itinerary status.\");\n    }\n    setTimeout(() => setSaveMessage(\"\"), 3000);\n  };\n  if (!routeSpots.length || !userLocation) return /*#__PURE__*/_jsxDEV(\"p\", {\n    style: {\n      textAlign: \"center\",\n      marginTop: 50\n    },\n    children: \"Loading route...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 234,\n    columnNumber: 12\n  }, this);\n  const userIcon = new L.Icon({\n    iconUrl: \"https://cdn-icons-png.flaticon.com/512/149/149060.png\",\n    iconSize: [32, 32]\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      height: \"100vh\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: [userLocation.lat, userLocation.lng],\n        zoom: 13,\n        style: {\n          height: \"100%\",\n          width: \"100%\"\n        },\n        whenCreated: map => mapRef.current = map,\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Marker, {\n          position: [userLocation.lat, userLocation.lng],\n          icon: userIcon,\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"You are here\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 15\n            }, this), \"Lat: \", userLocation.lat.toFixed(5), \", Lng: \", userLocation.lng.toFixed(5)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), routeSpots.map((poi, i) => {\n          var _poiDetails$i;\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            position: [poi.lat, poi.lng],\n            icon: numberedIcon(i + 1),\n            children: /*#__PURE__*/_jsxDEV(Popup, {\n              children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                children: [\"Stop \", i + 1, \": \", poi.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: ((_poiDetails$i = poiDetails[i]) === null || _poiDetails$i === void 0 ? void 0 : _poiDetails$i.description) || \"No description available.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 15\n            }, this)\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 13\n          }, this);\n        }), segments.map((seg, i) => /*#__PURE__*/_jsxDEV(Polyline, {\n          positions: seg.coords,\n          color: \"#1976d2\",\n          weight: 5\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        padding: 24,\n        background: \"#f5f5f5\",\n        overflowY: \"auto\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Itinerary Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Status: \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: status\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n        children: routeSpots.map((spot, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: () => handleZoomToPoi(spot),\n          style: {\n            cursor: \"pointer\"\n          },\n          children: spot.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 9\n      }, this), status === \"pending\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSaveItinerary,\n        disabled: saving,\n        style: {\n          width: \"100%\",\n          marginTop: 12\n        },\n        children: saving ? \"Saving...\" : \"ðŸ’¾ Save Itinerary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 11\n      }, this), status === \"pending\" && savedItineraryId && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => updateStatus(\"finished\"),\n          style: {\n            width: \"100%\",\n            marginTop: 10,\n            background: \"#4caf50\",\n            color: \"#fff\"\n          },\n          children: \"Finish Trip\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => updateStatus(\"cancelled\"),\n          style: {\n            width: \"100%\",\n            marginTop: 10,\n            background: \"#f44336\",\n            color: \"#fff\"\n          },\n          children: \"Cancel Trip\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), saveMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          marginTop: 10,\n          color: \"#1565c0\"\n        },\n        children: saveMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate(\"/\"),\n        style: {\n          width: \"100%\",\n          marginTop: 12\n        },\n        children: \"Back to Planner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 242,\n    columnNumber: 5\n  }, this);\n}\n_s(RouteDetails, \"33Gf75JvekgjP2GKHCSq/jiDOvA=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = RouteDetails;\nvar _c;\n$RefreshReg$(_c, \"RouteDetails\");","map":{"version":3,"names":["React","useEffect","useState","useRef","MapContainer","TileLayer","Marker","Popup","Polyline","L","useNavigate","useLocation","jsxDEV","_jsxDEV","Fragment","_Fragment","RouteDetails","_s","_location$state","location","navigate","routeSpots","state","itinerary","segments","setSegments","loading","setLoading","poiDetails","setPoiDetails","saving","setSaving","saveMessage","setSaveMessage","status","setStatus","savedItineraryId","setSavedItineraryId","userLocation","setUserLocation","mapRef","ORS_API_KEY","numberedIcon","number","divIcon","html","className","iconSize","navigator","lat","lng","watchId","geolocation","watchPosition","pos","loc","coords","latitude","longitude","current","setView","animate","err","console","warn","message","enableHighAccuracy","timeout","maximumAge","clearWatch","fetchPoiDetails","res","fetch","data","json","matched","map","spot","find","poi","name","id","error","snapToRoad","_data$snappedLocation","method","headers","Authorization","body","JSON","stringify","coordinates","snappedLocations","length","fetchRouteSegment","from","to","snappedFrom","snappedTo","_data$features","preference","instructions","features","geometry","summary","properties","distance","duration","loadAllSegments","points","segs","i","seg","push","handleZoomToPoi","formatDistance","meters","toFixed","formatDuration","seconds","Math","floor","handleSaveItinerary","token","localStorage","getItem","alert","Date","toLocaleDateString","route_data","ok","setTimeout","updateStatus","newStatus","success","style","textAlign","marginTop","children","fileName","_jsxFileName","lineNumber","columnNumber","userIcon","Icon","iconUrl","display","height","flex","center","zoom","width","whenCreated","url","position","icon","_poiDetails$i","description","positions","color","weight","padding","background","overflowY","onClick","cursor","disabled","_c","$RefreshReg$"],"sources":["C:/xampp/htdocs/Majayjay Tourism Circuit/src/pages/RouteDetails.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport L from \"leaflet\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\n\r\nexport default function RouteDetails() {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const routeSpots = location.state?.itinerary || [];\r\n\r\n  const [segments, setSegments] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [poiDetails, setPoiDetails] = useState([]);\r\n  const [saving, setSaving] = useState(false);\r\n  const [saveMessage, setSaveMessage] = useState(\"\");\r\n  const [status, setStatus] = useState(\"pending\");\r\n  const [savedItineraryId, setSavedItineraryId] = useState(null);\r\n  const [userLocation, setUserLocation] = useState(null);\r\n  const mapRef = useRef(null);\r\n\r\n  const ORS_API_KEY =\r\n    \"eyJvcmciOiI1YjNjZTM1OTc4NTExMTAwMDFjZjYyNDgiLCJpZCI6ImJhNWU3NmIxOTRmMzQyYTg4NzY4MDc2MzVmZDY1ZDRhIiwiaCI6Im11cm11cjY0In0=\";\r\n\r\n  // ðŸ”µ Custom numbered icon\r\n  const numberedIcon = (number) =>\r\n    L.divIcon({\r\n      html: `<div style=\"\r\n        background:#1976d2;\r\n        color:#fff;\r\n        width:28px;\r\n        height:28px;\r\n        border-radius:50%;\r\n        text-align:center;\r\n        line-height:28px;\r\n        font-weight:600;\r\n        border:2px solid #fff;\r\n        box-shadow:0 2px 6px rgba(0,0,0,0.3);\r\n      \">${number}</div>`,\r\n      className: \"\",\r\n      iconSize: [28, 28],\r\n    });\r\n\r\n  // Track live user location\r\n  useEffect(() => {\r\n    if (!(\"geolocation\" in navigator)) {\r\n      setUserLocation({ lat: 14.1461, lng: 121.5012 });\r\n      return;\r\n    }\r\n    const watchId = navigator.geolocation.watchPosition(\r\n      (pos) => {\r\n        const loc = { lat: pos.coords.latitude, lng: pos.coords.longitude };\r\n        setUserLocation(loc);\r\n        if (mapRef.current) {\r\n          try {\r\n            mapRef.current.setView([loc.lat, loc.lng], 14, { animate: true });\r\n          } catch {}\r\n        }\r\n      },\r\n      (err) => {\r\n        console.warn(\"Geolocation error:\", err.message);\r\n        setUserLocation({ lat: 14.1461, lng: 121.5012 });\r\n      },\r\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\r\n    );\r\n    return () => navigator.geolocation.clearWatch(watchId);\r\n  }, []);\r\n\r\n  // Fetch POI details from backend\r\n  const fetchPoiDetails = async () => {\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/api/pois\");\r\n      const data = await res.json();\r\n      const matched = routeSpots.map((spot) =>\r\n        data.find((poi) => poi.name === spot.name || poi.id === spot.id)\r\n      );\r\n      setPoiDetails(matched);\r\n    } catch (err) {\r\n      console.error(\"Error fetching POI details:\", err);\r\n    }\r\n  };\r\n\r\n  // Snap POI to road\r\n  const snapToRoad = async (poi) => {\r\n    try {\r\n      const res = await fetch(\"https://api.openrouteservice.org/v2/snap/driving-car\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: ORS_API_KEY,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ coordinates: [[poi.lng, poi.lat]] }),\r\n      });\r\n      const data = await res.json();\r\n      if (data.snappedLocations?.length) {\r\n        const [lng, lat] = data.snappedLocations[0].location;\r\n        return { lat, lng };\r\n      }\r\n      return poi;\r\n    } catch {\r\n      return poi;\r\n    }\r\n  };\r\n\r\n  // Fetch route segments\r\n  const fetchRouteSegment = async (from, to) => {\r\n    if (!from || !to) return null;\r\n    const snappedFrom = await snapToRoad(from);\r\n    const snappedTo = await snapToRoad(to);\r\n    try {\r\n      const res = await fetch(\r\n        \"https://api.openrouteservice.org/v2/directions/driving-car/geojson\",\r\n        {\r\n          method: \"POST\",\r\n          headers: {\r\n            Authorization: ORS_API_KEY,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify({\r\n            coordinates: [\r\n              [snappedFrom.lng, snappedFrom.lat],\r\n              [snappedTo.lng, snappedTo.lat],\r\n            ],\r\n            preference: \"fastest\",\r\n            instructions: false,\r\n          }),\r\n        }\r\n      );\r\n      const data = await res.json();\r\n      if (data.features?.length) {\r\n        const coords = data.features[0].geometry.coordinates.map(([lng, lat]) => [lat, lng]);\r\n        const summary = data.features[0].properties.summary;\r\n        return { coords, summary };\r\n      }\r\n    } catch {\r\n      return {\r\n        coords: [\r\n          [from.lat, from.lng],\r\n          [to.lat, to.lng],\r\n        ],\r\n        summary: { distance: 0, duration: 0 },\r\n      };\r\n    }\r\n  };\r\n\r\n  // Load segments & POIs\r\n  useEffect(() => {\r\n    const loadAllSegments = async () => {\r\n      if (!userLocation) return;\r\n      setLoading(true);\r\n      await fetchPoiDetails();\r\n      const points = [userLocation, ...routeSpots];\r\n      const segs = [];\r\n      for (let i = 0; i < points.length - 1; i++) {\r\n        const seg = await fetchRouteSegment(points[i], points[i + 1]);\r\n        if (seg) segs.push(seg);\r\n      }\r\n      setSegments(segs);\r\n      setLoading(false);\r\n    };\r\n    if (routeSpots.length > 0) loadAllSegments();\r\n  }, [userLocation, routeSpots]);\r\n\r\n  const handleZoomToPoi = (poi) => {\r\n    if (mapRef.current) mapRef.current.setView([poi.lat, poi.lng], 16, { animate: true });\r\n  };\r\n\r\n  const formatDistance = (meters) => `${(meters / 1000).toFixed(2)} km`;\r\n  const formatDuration = (seconds) => `${Math.floor(seconds / 60)} min`;\r\n\r\n  // Save itinerary\r\n  const handleSaveItinerary = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      alert(\"Please log in to save itineraries.\");\r\n      return;\r\n    }\r\n    setSaving(true);\r\n    setSaveMessage(\"\");\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/api/itineraries\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          name: `Route - ${new Date().toLocaleDateString()}`,\r\n          route_data: routeSpots,\r\n        }),\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        setSaveMessage(\"âœ… Itinerary saved successfully!\");\r\n        setStatus(\"pending\");\r\n        setSavedItineraryId(data.itinerary.id);\r\n      } else setSaveMessage(`âŒ Failed: ${data.message || \"Unknown error\"}`);\r\n    } catch {\r\n      setSaveMessage(\"âŒ Server error while saving itinerary.\");\r\n    } finally {\r\n      setSaving(false);\r\n      setTimeout(() => setSaveMessage(\"\"), 4000);\r\n    }\r\n  };\r\n\r\n  // Update status (Finish / Cancel)\r\n  const updateStatus = async (newStatus) => {\r\n    if (!savedItineraryId) return alert(\"Please save itinerary first.\");\r\n    const token = localStorage.getItem(\"token\");\r\n    try {\r\n      const res = await fetch(\r\n        `http://localhost:5000/api/itineraries/${savedItineraryId}/status`,\r\n        {\r\n          method: \"PUT\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          body: JSON.stringify({ status: newStatus }),\r\n        }\r\n      );\r\n      const data = await res.json();\r\n      if (res.ok && data.success) {\r\n        setStatus(newStatus);\r\n        setSaveMessage(`Itinerary ${newStatus} successfully.`);\r\n      } else setSaveMessage(\"Failed to update status.\");\r\n    } catch {\r\n      setSaveMessage(\"Error updating itinerary status.\");\r\n    }\r\n    setTimeout(() => setSaveMessage(\"\"), 3000);\r\n  };\r\n\r\n  if (!routeSpots.length || !userLocation)\r\n    return <p style={{ textAlign: \"center\", marginTop: 50 }}>Loading route...</p>;\r\n\r\n  const userIcon = new L.Icon({\r\n    iconUrl: \"https://cdn-icons-png.flaticon.com/512/149/149060.png\",\r\n    iconSize: [32, 32],\r\n  });\r\n\r\n  return (\r\n    <div style={{ display: \"flex\", height: \"100vh\" }}>\r\n      {/* Map */}\r\n      <div style={{ flex: 3 }}>\r\n        <MapContainer\r\n          center={[userLocation.lat, userLocation.lng]}\r\n          zoom={13}\r\n          style={{ height: \"100%\", width: \"100%\" }}\r\n          whenCreated={(map) => (mapRef.current = map)}\r\n        >\r\n          <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n\r\n          {/* Current location */}\r\n          <Marker position={[userLocation.lat, userLocation.lng]} icon={userIcon}>\r\n            <Popup>\r\n              <b>You are here</b>\r\n              <br />\r\n              Lat: {userLocation.lat.toFixed(5)}, Lng: {userLocation.lng.toFixed(5)}\r\n            </Popup>\r\n          </Marker>\r\n\r\n          {/* POI markers */}\r\n          {routeSpots.map((poi, i) => (\r\n            <Marker key={i} position={[poi.lat, poi.lng]} icon={numberedIcon(i + 1)}>\r\n              <Popup>\r\n                <b>Stop {i + 1}: {poi.name}</b>\r\n                <p>{poiDetails[i]?.description || \"No description available.\"}</p>\r\n              </Popup>\r\n            </Marker>\r\n          ))}\r\n\r\n          {/* Route polylines */}\r\n          {segments.map((seg, i) => (\r\n            <Polyline key={i} positions={seg.coords} color=\"#1976d2\" weight={5} />\r\n          ))}\r\n        </MapContainer>\r\n      </div>\r\n\r\n      {/* Sidebar */}\r\n      <div\r\n        style={{\r\n          flex: 1,\r\n          padding: 24,\r\n          background: \"#f5f5f5\",\r\n          overflowY: \"auto\",\r\n        }}\r\n      >\r\n        <h2>Itinerary Details</h2>\r\n        <p>Status: <b>{status}</b></p>\r\n        <ol>\r\n          {routeSpots.map((spot, i) => (\r\n            <li key={i} onClick={() => handleZoomToPoi(spot)} style={{ cursor: \"pointer\" }}>\r\n              {spot.name}\r\n            </li>\r\n          ))}\r\n        </ol>\r\n\r\n        {/* Save button */}\r\n        {status === \"pending\" && (\r\n          <button onClick={handleSaveItinerary} disabled={saving} style={{ width: \"100%\", marginTop: 12 }}>\r\n            {saving ? \"Saving...\" : \"ðŸ’¾ Save Itinerary\"}\r\n          </button>\r\n        )}\r\n\r\n        {/* Finish / Cancel */}\r\n        {status === \"pending\" && savedItineraryId && (\r\n          <>\r\n            <button onClick={() => updateStatus(\"finished\")} style={{ width: \"100%\", marginTop: 10, background: \"#4caf50\", color: \"#fff\" }}>\r\n              Finish Trip\r\n            </button>\r\n            <button onClick={() => updateStatus(\"cancelled\")} style={{ width: \"100%\", marginTop: 10, background: \"#f44336\", color: \"#fff\" }}>\r\n              Cancel Trip\r\n            </button>\r\n          </>\r\n        )}\r\n\r\n        {saveMessage && <p style={{ marginTop: 10, color: \"#1565c0\" }}>{saveMessage}</p>}\r\n\r\n        <button onClick={() => navigate(\"/\")} style={{ width: \"100%\", marginTop: 12 }}>\r\n          Back to Planner\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}